
# Лабораторна робота 4: Шифрування та розшифрування файлів за допомогою AES-256

## Вступ
Ця лабораторна робота присвячена реалізації шифрування та розшифрування файлів за допомогою AES-256 у режимі CBC, з використанням хешування пароля за алгоритмом SHA-256 для отримання ключа. OpenSSL використовується для криптографічних операцій, а C++ відповідає за роботу з файлами.

## Мета
- Шифрувати та розшифровувати файли безпечно за допомогою AES-256 у режимі CBC.
- Отримати AES-256 ключ з пароля користувача за допомогою хешування SHA-256.

---

## Як працює код

### 1. Отримання ключа на основі пароля (`sha256`)
Користувач вводить пароль, який хешується за допомогою SHA-256 для отримання 32-байтового AES-256 ключа. Ця функція використовує API OpenSSL `EVP_MD_CTX` для виконання хешування.

**Кроки:**
- Ініціалізується контекст хешування за допомогою `EVP_DigestInit_ex`.
- Оновлюється контекст даними пароля за допомогою `EVP_DigestUpdate`.
- Отримується кінцевий хеш за допомогою `EVP_DigestFinal_ex`.

### 2. AES Шифрування (`aes_encrypt`)
- **Ініціалізація**: Випадково генерується 16-байтовий IV (ініціалізаційний вектор) за допомогою `RAND_bytes`, щоб забезпечити випадковість у шифруванні.
- **Шифрування файлу**: Вхідний файл зчитується блоками, шифрується за допомогою AES-256 у режимі CBC, а результат записується у вихідний файл.
- **Зберігання IV**: IV додається до початку вихідного файлу, що є важливим для подальшої розшифровки.

**Кроки:**
- Ініціалізація контексту шифрування AES за допомогою `EVP_EncryptInit_ex`.
- Дані шифруються блоками за допомогою `EVP_EncryptUpdate`.
- Останній блок шифрування обробляється за допомогою `EVP_EncryptFinal_ex`, що забезпечує додавання необхідного заповнення.
- Шифровані дані та IV записуються у вихідний файл.

### 3. AES Розшифрування (`aes_decrypt`)
- **Читання IV**: IV зчитується з початку зашифрованого файлу.
- **Розшифрування файлу**: Залишок зашифрованого вмісту розшифровується за допомогою раніше зчитаного IV та AES-256 ключа.

**Кроки:**
- Ініціалізація контексту розшифрування за допомогою `EVP_DecryptInit_ex`.
- Дані розшифровуються блоками за допомогою `EVP_DecryptUpdate`.
- Останній блок обробляється за допомогою `EVP_DecryptFinal_ex`.

Розшифровані дані записуються у вихідний файл.

### 4. Логіка головної програми
- Користувач вводить пароль, операцію (`encrypt` або `decrypt`), шлях до вхідного та вихідного файлів.
- Програма хешує пароль для отримання AES-256 ключа.
- Залежно від вибору користувача, викликається або `aes_encrypt`, або `aes_decrypt`.
- Після успішного шифрування або розшифрування програма виводить повідомлення про успіх.

---

## Приклад виконання
1. **Шифрування**:
   - Пароль хешується для отримання AES-256 ключа.
   - Вхідний файл шифрується за допомогою AES-256 CBC, і IV додається до початку вихідного файлу.

2. **Розшифрування**:
   - IV зчитується із зашифрованого файлу.
   - Файл розшифровується за допомогою AES-256 CBC та отриманого ключа.

---

## Як запустити
1. **Зібрати програму**:
   ```
    make
   ```

2. **Запустити шифрування**:
   ```
   ./aes_crypto_app
   ```

3. **Запустити розшифрування**:
   ```
   ./aes_crypto_app
   ```

## Висновок
Ця лабораторна робота демонструє безпечний спосіб шифрування та розшифрування файлів за допомогою AES-256 у режимі CBC. Використання хешування для отримання ключа забезпечує надійність зв'язку між шифруванням та введеним користувачем паролем, а використання IV забезпечує унікальність кожної операції шифрування.
